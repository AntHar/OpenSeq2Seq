

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Centaur &mdash; OpenSeq2Seq 0.2 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Language Model" href="../language-model.html" />
    <link rel="prev" title="WaveNet" href="wavenet.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> OpenSeq2Seq
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../machine-translation.html">Machine Translation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech-recognition.html">Speech Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech-commands.html">Speech Commands</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../speech-synthesis.html">Speech Synthesis</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../speech-synthesis.html#models">Models</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tacotron-2.html">Tacotron 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="tacotron-2-gst.html">Tacotron 2 with Global Style Tokens</a></li>
<li class="toctree-l3"><a class="reference internal" href="wavenet.html">WaveNet</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Centaur</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#model">Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#encoder">Encoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="#decoder">Decoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loss">Loss</a></li>
<li class="toctree-l4"><a class="reference internal" href="#training">Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tips-and-tricks">Tips and Tricks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#audio-samples">Audio Samples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../speech-synthesis.html#getting-started">Getting started</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../language-model.html">Language Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sentiment-analysis.html">Sentiment Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distr-training.html">Multi-GPU and Distributed Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mixed-precision.html">Mixed Precision Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizers.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../in-depth-tutorials.html">In-depth Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interactive-infer-demos.html">Interactive Infer Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-docs/modules.html">API documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OpenSeq2Seq</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../speech-synthesis.html">Speech Synthesis</a> &raquo;</li>
        
      <li>Centaur</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/speech-synthesis/centaur.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="centaur">
<span id="id1"></span><h1>Centaur<a class="headerlink" href="#centaur" title="Permalink to this headline">¶</a></h1>
<div class="section" id="model">
<h2>Model<a class="headerlink" href="#model" title="Permalink to this headline">¶</a></h2>
<p>Centaur is our hand-designed encoder-decoder model based on the
<a class="reference external" href="https://arxiv.org/pdf/1809.08895.pdf">Neural Speech Synthesis with Transformer Network</a>
and <a class="reference external" href="https://arxiv.org/pdf/1710.07654.pdf">Deep Voice 3</a> papers.</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../_images/centaur.png"><img alt="../_images/centaur.png" src="../_images/centaur.png" style="width: 611.6px; height: 888.8000000000001px;" /></a>
<p class="caption"><span class="caption-text">Centaur Model</span></p>
</div>
</div>
<div class="section" id="encoder">
<h2>Encoder<a class="headerlink" href="#encoder" title="Permalink to this headline">¶</a></h2>
<p>The encoder architecture is simple. It consists of an embedding layer and a few convolutional blocks
followed by a linear projection.</p>
<p>Each convolution block is represented by a convolutional layer followed by batch normalization and ReLU
with dropout and residual connection:</p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../_images/centaur_conv_block.png"><img alt="../_images/centaur_conv_block.png" src="../_images/centaur_conv_block.png" style="width: 208.8px; height: 381.6px;" /></a>
<p class="caption"><span class="caption-text">Centaur Convolutional Block</span></p>
</div>
</div>
<div class="section" id="decoder">
<h2>Decoder<a class="headerlink" href="#decoder" title="Permalink to this headline">¶</a></h2>
<p>The decoder architecture is more complicated. It is comprised of a pre-net, attention blocks, convolutional blocks, and
linear projections.</p>
<p>The pre-net is represented by 2 fully connected layers with ReLU activation and a final linear projection.</p>
<p>The attention block is similar to the transformer block described in the
<a class="reference external" href="https://arxiv.org/pdf/1706.03762.pdf">Attention Is All You Need</a> paper,
but the self-attention mechanism was replaced with our convolutional block and a single attention head is used.
The aim of Centaur’s attention block is to learn proper monotonic encoder-decoder attention. Also we should mention here that
we add positional encoding to encoder and pre-net outputs without any trainable weights.</p>
<p>The next few convolutional blocks followed by two linear projections predict the mel spectogram and the stop token.
Additional convolutional blocks with linear projection are used to predict the final magnitude spectogram, which is used
by the Griffin-Lim algorithm to generate speech.</p>
</div>
<div class="section" id="loss">
<h2>Loss<a class="headerlink" href="#loss" title="Permalink to this headline">¶</a></h2>
<p>We use L1 norm to penalize mel and magnitude spectogram predictions. Because we do not use mel spectograms to generate
speech, one can consider it as an auxiliary loss. Cross entropy loss is used for stop token predictions.</p>
</div>
<div class="section" id="training">
<h2>Training<a class="headerlink" href="#training" title="Permalink to this headline">¶</a></h2>
<p>The model is trained with NovoGrad with an initial learning rate of 1e-2 with a polynomial decay.
Also L2 regularization was used during the training.</p>
</div>
<div class="section" id="tips-and-tricks">
<h2>Tips and Tricks<a class="headerlink" href="#tips-and-tricks" title="Permalink to this headline">¶</a></h2>
<p>One of the most important tasks of the model is to learn a smooth monotonic attention. If the alignment is poor,
the model can skip or repeat words, which is undesirable. We can help the model achieve this goal using two tricks.
The first one is to use a reduction factor, which means to predict multiple frames per time step. The smaller this
number is, the better the voice quality will be. However, monotonic attention will be more difficult to learn. In our experiments we generate 2 audio frames
per step. The second trick is to force monotonic attention during inference using a fixed size window.</p>
</div>
<div class="section" id="audio-samples">
<h2>Audio Samples<a class="headerlink" href="#audio-samples" title="Permalink to this headline">¶</a></h2>
<p>Audio samples with the centaur model can be found <a class="reference internal" href="centaur-samples.html"><span class="doc">here</span></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../language-model.html" class="btn btn-neutral float-right" title="Language Model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="wavenet.html" class="btn btn-neutral" title="WaveNet" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, NVIDIA.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.2',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script>  
  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #64d81c;
    }
    .wy-side-nav-search > div.version {
      color: #ffffff;
    }
    .wy-side-nav-search > img {
      max-width: 150px;
    }
    .wy-side-nav-search > a {
      font-size: 23px;
    }
  </style>


</body>
</html>