

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Creation of Synthetic Data &mdash; OpenSeq2Seq 0.2 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Speech Commands" href="../speech-commands.html" />
    <link rel="prev" title="Jasper" href="jasper.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> OpenSeq2Seq
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using-existing-models.html">Using Existing Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distr-training.html">Multi-GPU and Distributed Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mixed-precision.html">Mixed Precision Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimizers.html">Optimizers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../speech-recognition.html">Speech Recognition</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../speech-recognition.html#models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../speech-recognition.html#getting-started">Getting started</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../speech-recognition.html#synthetic-data">Synthetic data</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Creation of Synthetic Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#training-with-synthetic-data">Training With Synthetic Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../speech-recognition.html#tools">Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../speech-commands.html">Speech Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speech-synthesis.html">Speech Synthesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../machine-translation.html">Machine Translation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language-model.html">Language Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sentiment-analysis.html">Sentiment Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../image-classification.html">Image Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interactive-infer-demos.html">Interactive Infer Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adding-new-models.html">Adding new models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api-docs/modules.html">API documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OpenSeq2Seq</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../speech-recognition.html">Speech Recognition</a> &raquo;</li>
        
      <li>Creation of Synthetic Data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/speech-recognition/synthetic_dataset.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="creation-of-synthetic-data">
<span id="synthetic-data"></span><h1>Creation of Synthetic Data<a class="headerlink" href="#creation-of-synthetic-data" title="Permalink to this headline">¶</a></h1>
<p>Creating a synthetic dataset requires a trained speech synthesis model. This tutorial assumes that you have a trained Tactron 2 with Global Style Tokens. For details on how to train this model, see <a class="reference internal" href="../speech-synthesis/tacotron-2-gst.html"><span class="doc">here</span></a>.</p>
<p>We first need to create an infer csv that pairs MAILABS wav files with LibriSpeech transcripts through tacotron_gst_create_infer_csv.py. Using this infer csv, we can start generating audio through tacotron_gst_create_syn_data.py. Last, we need to create a csv that can be used to train speech recognition models that pairs the synthetic wavs with their transcripts through nsr_create_syn_train_csv.py.</p>
<dl class="docutils">
<dt>Steps:</dt>
<dd><ol class="first last arabic simple">
<li>Inside tacotron_gst_create_infer_csv.py, change MAILABS_data_root and libri_data_root
to where the MAILABS and LibriSpeech datasets are located</li>
<li>Run tacotron_gst_create_infer_csv.py, it will create a file called generate.csv</li>
<li>Move tacotron_gst_create_syn_data.py to the top-level OpenSeq2Seq directory
where run.py is located, or otherwise ensure that the OpenSeq2Seq imports
will be loaded</li>
<li>Change config_file_path, checkpoint_path, and syn_save_dir as needed. config_file_path
should point to tacotron_gst.py. checkpoint_path should be the directory holding the
tacotron-gst checkpoints. syn_save_dir should be an existing directory where the synthetic
wavs will be saved to.</li>
<li>Run tacotron_gst_create_syn_data.py. 281241 wav files will be created. Note
that the generation of a synthetic dataset could take as long as 1 day.</li>
<li>Repeat steps 1-5 as many times as needed. You can change the decoder dropout
parameter if wanted on line 63 of tacotron2_decoder.py if wanted. Be sure to
save to a different directory to avoid overwriting the files.</li>
<li>You should have a folder containing a number of sub-directories with each
sub-directory holding a different synthetic dataset, each the size of
LibriSpeech, depending on how many times step 6 was done.</li>
<li>Inside nsr_create_syn_train_csv.py, change synthetic_data_root to point on the folder
mentioned in step 7.</li>
<li>Run nsr_create_syn_train_csv.py, this will create synthetic_data.csv.</li>
<li>Add synthetic_data.csv to your speech recognition config under <code class="docutils literal notranslate"><span class="pre">dataset_files</span></code>.
Add <code class="docutils literal notranslate"><span class="pre">syn_enable</span></code> and set it to True. Add <code class="docutils literal notranslate"><span class="pre">syn_subdirs</span></code> which is a list
of strings containing the names of the sub-directories mentioned in step 7.</li>
<li>Train with this new config file.</li>
</ol>
</dd>
</dl>
</div>
<div class="section" id="training-with-synthetic-data">
<h1>Training With Synthetic Data<a class="headerlink" href="#training-with-synthetic-data" title="Permalink to this headline">¶</a></h1>
<p>We found that augmenting LibriSpeech with synthetic data allowed for a large improvement in WER compared to training on only LibriSpeech and training with traditional speech augmentation. Despite the larger amount of synthetic data, models performed best if the training data was sampled at a 50-50 ratio between LibriSpeech and synthetic samples. Since the size of the synthetic dataset is the same as the training set of LibriSpeech, this should be done automatically if training using the steps above.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../speech-commands.html" class="btn btn-neutral float-right" title="Speech Commands" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="jasper.html" class="btn btn-neutral" title="Jasper" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, NVIDIA.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.2',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script>  
  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #64d81c;
    }
    .wy-side-nav-search > div.version {
      color: #ffffff;
    }
    .wy-side-nav-search > img {
      max-width: 150px;
    }
    .wy-side-nav-search > a {
      font-size: 23px;
    }
  </style>


</body>
</html>